<!DOCTYPE html>
<html lang="en">

<!--

# Original license:

MIT License

Copyright (c) 2020 Freeware Lovers

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

https://github.com/freewarelovers/PasswordGenerator/

# Licensing info:

https://gitlab.com/c9x3/license/-/raw/main/LICENSE.md

# Web-page(s) to reference: 

‚û§ https://stackoverflow.com/questions/29884654/button-that-refreshes-the-page-on-click#29884677

-->

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>C9x3's Libre Password Generator</title>

<link rel="icon" type="image/png" sizes="32x32" href="Hydrogen_32x32.png" />

<!-- Styling for webpage -->

<style type="text/css">

/* */

html {

background-color: rgb(62, 55, 95); 
font-family: sans-serif;
font-size: 130%; <!-- Background color for HTML. -->

} 

/* */

body {

max-width: 40em; 
margin-left: auto;
margin-right: auto; <!-- Start of centering -->

}

/* */
               
h1 {

/* */

text-align: center;
font-size: 160%; <!-- End of centering -->

}

/* */

form .show_statistics {

background-color: rgb(2, 20, 27); 
border: 0.05em solid #E0E0E0;
padding: 1em 1em;
border-radius: 1em; 

<!-- Background area for statistics area. You can also change the border color. 

# An example of how padding works: 

"padding: 0.05em 1em" <- This will be our example.  

# Vertical: 

First = up and down (vertical.) ‚áÖ 

Reading from left to right, the higher the value, the lower the element goes. The lower the value, the higher the element goes.

In this example, the vertical value will be moving the element a value of 0.05 up.

# Horizontal: 

Second = left and right (horizontal.) ‚áÑ 

Reading from left to right, the higher the value, the more to the right the element will go. The lower the value, the more to the left the value will go.

In this example, the horizontal value will be moving the element a value of 1 to the right.

-->

}

/* */

form .section {

background-color: rgb(2, 20, 27); 
border: 0.05em solid #E0E0E0;
padding: 0.3em 0.7em;
border-radius: 1em; <!-- Background area for settings area. You can also change the border color. -->

}

/* */

form #charset small {

font-size: 90%;
color: #ffffff; <!-- Color of text within settings area. -->

} 

/* */

form #password {

padding: 0.1em 0.3em;
font-size: 140%; 
margin-left: 0.3em; 
background-color: rgba(0, 0, 0, 0.548); 
border-radius: 1em; <!-- Color of password area. -->

}

/* */

a {

color: inherit;
text-decoration: none; <!-- Allows the color of the title to be changed. -->

}

/* */

a:hover {
text-decoration: underline; <!-- Must be hovering over the title to show the underline of the title. -->

} 

/* */

form input, form button {

font-family: inherit;
font-size: inherit; <!-- Continuity for button size. -->

} 

/* */

</style>

</head>

<body>

<font color="LightBlue"> <!-- Changing font color. -->

<h1><a target="_blank" href="https://gitlab.com/c9x3/c9x3s-libre-password-generator" title="Click here to visit my web repository!">C9x3's Libre Password Generator</a></h1>

A libre password generator that intends to stick to the,

<a target="_blank" href="https://en.wikipedia.org/wiki/KISS_principle" title="KISS principle = keep it simple, stupid.">

"KISS principle!"

</a>

</font> <!-- End of changing font color. -->

<font color="LightBlue"> <!-- Changing font color to LightBlue -->

     <form action="#" method="get" onsubmit="doGenerate(event);">

          <div id="charset" class="section" style="margin: 1em 0em">

               <p style="margin:0.3em 0em">Character set:</p>

               <table style="line-height:1.5">

                    <tbody>

                         <tr>

                              <td><input type="checkbox" id="custom"></td>

                              <td><label for="custom"> Custom:</label> <input type="text" id="customchars" value=""

                                        size="15" style="width:10em; font-size:80%"

                                        oninput="document.getElementById('custom').checked=true;"></td>
                         </tr>

                    </font> <!-- End of changing font color to LightBlue -->

                    </tbody>

               </table>

          </div>

          <div class="section">

               <table id="type">

                    <tbody>

                         <tr>

                              <td><input type="radio" name="type" id="by-length" checked="checked"> <label

                                        for="by-length">Length:&#xA0;</label></td>

                         <!-- Value for password character length. -->

                              <td><input type="number" min="0" value="25" step="1" id="length" style="width:4em"

                                        oninput="document.getElementById('by-length').checked=true;"> characters</td>

                         <!-- Value for Entropy. -->
                         
                         <tr>
                              <td><input type="radio" name="type" id="by-entropy"> <label

                                        for="by-entropy">Entropy:</label>&#xA0;</td>

                              <td><input type="number" min="0" value="128" step="any" id="entropy" style="width:4em"

                                        oninput="document.getElementById('by-entropy').checked=true;"> bits</td>

                         </tr>

                         <!-- End of value for Entropy. -->

                    </tbody>

               </table>

          </div>

          <p style="max-width:unset; line-height:1.35; word-break:break-all">

‚û§ All processes provided by this tool are handled completely locally meaning that this tool does <u>NOT</u> send passwords to any server(s.)<br>

<br>‚û§ <a target="_blank" href="https://gitlab.com/c9x3/license/-/raw/main/LICENSE.md" title="Licensing information!">Click here for this tools licensing information!</a></p>

‚û§ Hover over each button to see a brief description of what each button does!<br>

<br>‚û§ Statistics should show up in the box below if you generate a password! :)

<!-- Create box where statistics are shown. -->

     <!-- Spawn the top barrier --> <p id="statistics" class="show_statistics">&#xA0;</p>

          <!-- The statistics should be shown here in the GUI.-->

     <!-- Spawn the bottom barrier --> <p class="show_statistics" style="max-width:unset">

<!-- The statistics should NOT be passing through the top or bottom barriers! -->

<!--

# Extra options for the refresh page button (encase one option does NOT work inside of your browser!)

<button onClick="window.location.reload();">Refresh Page</button>

<button onClick="history.go(0);">Refresh Page</button>

-->

<button onClick="window.location.href=window.location.href" title="Clicking this WILL reset this webpage (including your settings!)">Refresh Page ‚ü≥</button>

               <input type="submit" title="Clicking this will generate a random password!" value="Generate üîí">
               <input type="button" title="Clicking this will copy your random password (if you have generated one) to your clipboard. Otherwise, this option is grayed out." value="Copy ‚úØ" id="copy-button" onclick="doCopy();" disabled="disabled">
               <br><br>Password: <br><br><span id="password"></span><br><br><br><br><br><br>

          </p>

     </form>

     <!-- JavaScript code -->

     <script>
          "use strict";


          /*-- Configuration --*/

          var CHARACTER_SETS = [
               [true, "Numbers", "0123456789"],
               [true, "Lowercase", "abcdefghijklmnopqrstuvwxyz"],
               [true, "Uppercase", "ABCDEFGHIJKLMNOPQRSTUVWXYZ"],
               [true, "ASCII symbols", "!\"#$%" + String.fromCharCode(38) + "'()*+,-./:;" + String.fromCharCode(60) + "=>?@[\\]^_`{|}~"],
               [false, "Space", " "],
          ];

          /*-- Global variables --*/

          var passwordElem = document.getElementById("password");
          var copyElem = document.getElementById("copy-button")
          var statisticsElem = document.getElementById("statistics" );
          var cryptoObject = null;
          var currentPassword = null;

          /*-- Initialization --*/

          function initCharsets() {
               function createElem(tagName, attribs) {
                    var result = document.createElement(tagName);
                    if (attribs !== undefined) {
                         for (var key in attribs)
                              result[key] = attribs[key];
                    }
                    return result;
               }

               var container = document.querySelector("#charset tbody");
               var endElem = document.querySelector("#charset tbody > tr:last-child");
               CHARACTER_SETS.forEach(function (entry, i) {
                    var tr = createElem("tr");
                    var td = createElem("td");
                    var input = createElem("input", {
                         type: "checkbox",
                         checked: entry[0],
                         id: "charset-" + i
                    });
                    td.appendChild(input);
                    tr.appendChild(td);
                    var td = createElem("td");
                    var label = createElem("label", {
                         htmlFor: "charset-" + i,
                         textContent: " " + entry[1] + " "
                    });
                    var small = createElem("small", {
                         textContent: "(" + entry[2] + ")"
                    })
                    label.appendChild(small);
                    td.appendChild(label);
                    tr.appendChild(td);
                    container.insertBefore(tr, endElem);
               });
          }

          function initCrypto() {
               var elem = document.getElementById("crypto-getrandomvalues-entropy");
               elem.textContent = "\u2717";  // X mark

               if ("crypto" in window)
                    cryptoObject = crypto;
               else if ("msCrypto" in window)
                    cryptoObject = msCrypto;
               else
                    return;

               if (!("getRandomValues" in cryptoObject) || !("Uint32Array" in window) || typeof Uint32Array != "function")
                    cryptoObject = null;
               else
                    elem.textContent = "\u2713";
          }

          /*-- Entry points from HTML code --*/

          function doGenerate(ev) {
               ev.preventDefault();

               // Get and check character set
               var charset = getPasswordCharacterSet();
               if (charset.length == 0) {
                    alert("Error: Character set is empty");
                    return;
               } else if (document.getElementById("by-entropy").checked ? charset.length == 1 : false) {
                    alert("Error: Need at least 2 distinct characters in set");
                    return;
               }

               // Calculate desired length
               var length;
               if (document.getElementById("by-length").checked)
                    length = parseInt(document.getElementById("length").value, 10);
               else if (document.getElementById("by-entropy").checked)
                    length = Math.ceil(parseFloat(document.getElementById("entropy").value) * Math.log(2) / Math.log(charset.length));
               else
                    throw "Assertion error";

               // Check length
               if (0 > length) {
                    alert("Negative password length");
                    return;
               } else if (length > 10000) {
                    alert("Password length too large");
                    return;
               }

               // Generate password
               currentPassword = generatePassword(charset, length);

               // Calculate and format entropy
               var entropy = Math.log(charset.length) * length / Math.log(2);
               var entropystr;
               if (70 > entropy)
                    entropystr = entropy.toFixed(2);
               else if (200 > entropy)
                    entropystr = entropy.toFixed(1);
               else
                    entropystr = entropy.toFixed(0);

               // Set output elements
               passwordElem.textContent = currentPassword;
               statisticsElem.textContent = "Character length = " + length + " characters. Character set set size = " +
                    charset.length + " symbols. Entropy value = " + entropystr + " bits.";
               copyElem.disabled = false;
          }

          function doCopy() {
               var container = document.querySelector("body");
               var textarea = document.createElement("textarea");
               textarea.style.position = "fixed";
               textarea.style.opacity = "0";
               container.insertBefore(textarea, container.firstChild);
               textarea.value = currentPassword;
               textarea.focus();
               textarea.select();
               document.execCommand("copy");
               container.removeChild(textarea);
          }

          /*-- Low-level functions --*/

          function getPasswordCharacterSet() {
               // Concatenate characters from every checked entry
               var rawCharset = "";
               CHARACTER_SETS.forEach(function (entry, i) {
                    if (document.getElementById("charset-" + i).checked)
                         rawCharset += entry[2];
               });
               if (document.getElementById("custom").checked)
                    rawCharset += document.getElementById("customchars").value;
               rawCharset = rawCharset.replace(/ /g, "\u00A0");  // Replace space with non-breaking space

               // Parse UTF-16, remove duplicates, convert to array of strings
               var charset = [];
               for (var i = 0; rawCharset.length > i; i++) {
                    var c = rawCharset.charCodeAt(i);
                    if (0xD800 > c || c >= 0xE000) {  // Regular UTF-16 character
                         var s = rawCharset.charAt(i);
                         if (charset.indexOf(s) == -1)
                              charset.push(s);
                         continue;
                    }
                    if (0xDC00 > c ? rawCharset.length > i + 1 : false) {  // High surrogate
                         var d = rawCharset.charCodeAt(i + 1);
                         if (d >= 0xDC00 ? 0xE000 > d : false) {  // Low surrogate
                              var s = rawCharset.substring(i, i + 2);
                              i++;
                              if (charset.indexOf(s) == -1)
                                   charset.push(s);
                              continue;
                         }
                    }
                    throw "Invalid UTF-16";
               }
               return charset;
          }

          function generatePassword(charset, len) {
               var result = "";
               for (var i = 0; len > i; i++)
                    result += charset[randomInt(charset.length)];
               return result;
          }

          // Returns a random integer in the range [0, n) using a variety of methods.
          function randomInt(n) {
               var x = randomIntMathRandom(n);
               x = (x + randomIntBrowserCrypto(n)) % n;
               return x;
          }

          // Not secure or high quality, but always available.
          function randomIntMathRandom(n) {
               var x = Math.floor(Math.random() * n);
               if (0 > x || x >= n)
                    throw "Arithmetic exception";
               return x;
          }

          // Uses a secure, unpredictable random number generator if available; otherwise returns 0.
          function randomIntBrowserCrypto(n) {
               if (cryptoObject == null)
                    return 0;
               // Generate an unbiased sample
               var x = new Uint32Array(1);
               do cryptoObject.getRandomValues(x);
               while (x[0] - x[0] % n > 4294967296 - n);
               return x[0] % n;
          }

          /*-- Initialization --*/

          initCharsets();
          initCrypto();
          copyElem.disabled = true;

     </script>

</body>

</html>

